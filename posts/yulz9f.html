<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>docker初探 | Khalid博客</title><meta name="author" content="Khalid,732060461@qq.com"><meta name="copyright" content="Khalid"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="docker初探"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/khalidfavicon.ico"><link rel="canonical" href="https://www.khalidlife.com/posts/yulz9f"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?e087d763f6827414e12f12bbd7b72698";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"AL6RMCBHYJ","apiKey":"d9cd126abd8a3b1452c2e7e181da3882","indexName":"kieran","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'docker初探',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-29 15:05:57'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Khalid博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/avatar_betacat_07.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类页</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Khalid博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类页</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">docker初探</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-03-10T04:43:50.000Z" title="发表于 2020-03-10 12:43:50">2020-03-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-29T07:05:57.040Z" title="更新于 2022-11-29 15:05:57">2022-11-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%B7%A5%E5%85%B7/docker/">docker</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id data-flag-title="docker初探"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="01-初识-Docker"><a href="#01-初识-Docker" class="headerlink" title="01 初识 Docker"></a>01 初识 Docker</h1><h2 id="1-1-What-is-Docker"><a href="#1-1-What-is-Docker" class="headerlink" title="1.1 What is Docker"></a>1.1 What is Docker</h2><h3 id="1-1-1-官网首页"><a href="#1-1-1-官网首页" class="headerlink" title="1.1.1 官网首页"></a>1.1.1 官网首页</h3><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.docker.com/">https://www.docker.com/</a></p>
<blockquote>
<p>Debug your app, not your environment<br>Securely build, share and run any application, anywhere</p>
</blockquote>
<h3 id="1-1-2-Docs"><a href="#1-1-2-Docs" class="headerlink" title="1.1.2 Docs"></a>1.1.2 Docs</h3><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.docker.com/get-started/">https://docs.docker.com/get-started/</a></p>
<blockquote>
<p>Docker is a platform for developers and sysadmins to develop, deploy, and run applications with containers. The use of Linux containers to deploy applications is called containerization. Containers are not new, but their use for easily deploying applications is.</p>
</blockquote>
<p>Docker 是供开发人员和系统管理员使用容器构建，共享和运行应用程序的平台。 使用容器部署应用程序称为容器化。 容器不是新的，但用于轻松部署应用程序的容器却是新的。</p>
<h3 id="1-1-3-不理解，我太难了"><a href="#1-1-3-不理解，我太难了" class="headerlink" title="1.1.3 不理解，我太难了"></a>1.1.3 不理解，我太难了</h3><p>不妨从一个需求开始 ：开发好了一个项目 study，部署上线</p>
<ul>
<li>远古时代<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1082206/1584290840067-82793bb1-cb8d-4642-ad08-e9b37e98fd4f.png#align=left&display=inline&height=559&margin=%5Bobject%20Object%5D&originHeight=559&originWidth=621&size=0&status=done&style=none&width=621"><br><strong>问题：</strong> 成本高、部署慢、浪费资源、硬件限制、不利于迁移扩展</li>
<li>虚拟化时代<br>hypervisor：虚拟化技术<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1082206/1584290839523-7aab960d-3f5b-4547-b430-e5367c80db24.png#align=left&display=inline&height=775&margin=%5Bobject%20Object%5D&originHeight=775&originWidth=802&size=0&status=done&style=none&width=802"><br><strong>优点</strong> ：相对利用好资源，相对容易扩展等。<br><strong>缺点</strong> ：虚拟机太重了，一上来占用较多物理资源，移植性差，资源利用率低等。</li>
<li>容器时代<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1082206/1584290842846-069a8eb5-cfb0-411d-9b7f-930350fad7c9.png#align=left&display=inline&height=1039&margin=%5Bobject%20Object%5D&originHeight=1039&originWidth=1200&size=0&status=done&style=none&width=1200"></li>
</ul>
<h3 id="1-1-4-再次理解-Docker"><a href="#1-1-4-再次理解-Docker" class="headerlink" title="1.1.4 再次理解 Docker"></a>1.1.4 再次理解 Docker</h3><blockquote>
<p>Docker is a platform for developers and sysadmins to build, share, and run applications with containers. The use of containers to deploy applications is called containerization. Containers are not new, but their use for easily deploying applications is.</p>
</blockquote>
<p>Docker 是供开发人员和系统管理员使用容器构建，共享和运行应用程序的平台。 使用容器部署应用程序称为容器化。 容器不是新的，但用于轻松部署应用程序的容器却是新的。</p>
<p>发现还是比较容易理解的，但是这里有一句“Containers are not new”，也就是容器化技术很早就 出现了，比如常见的容器化技术有 OpenVZ 等。</p>
<h3 id="1-1-5-Docker-的优势和应用场景"><a href="#1-1-5-Docker-的优势和应用场景" class="headerlink" title="1.1.5 Docker 的优势和应用场景"></a>1.1.5 Docker 的优势和应用场景</h3><ol>
<li>有助于微服务的落地和部署</li>
<li>充分利用物理机资源，同时能够整合服务器资源</li>
<li>提高开发效率，测试效率，部署效率，有利于 DevOps 的落地，CI/CD</li>
<li>云原生落地，应用更好地迁移 …</li>
</ol>
<h2 id="1-2-What-is-Image-and-Container"><a href="#1-2-What-is-Image-and-Container" class="headerlink" title="1.2 What is Image and Container?"></a>1.2 What is Image and Container?</h2><p>docker engine  –》 jvm<br>image –》 class 文件<br>container –》 Java 对象</p>
<h3 id="1-2-1-What-is-Image"><a href="#1-2-1-What-is-Image" class="headerlink" title="1.2.1 What is Image?"></a>1.2.1 What is Image?</h3><p>Why is docker?-&gt; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.docker.com/resources/what-container">https://www.docker.com/resources/what-container</a></p>
<blockquote>
<p>A Docker container image is a lightweight, standalone, executable package of software that includes everything needed to run an application: code, runtime, system tools, system libraries and settings.</p>
</blockquote>
<p>Docker 容器映像是轻巧的，独立的，可执行的软件软件包，其中包含运行应用程序所需的一切：代码，运行时，系统工具，系统库和设置。</p>
<h3 id="1-2-2-What-is-Container？"><a href="#1-2-2-What-is-Container？" class="headerlink" title="1.2.2 What is Container？"></a>1.2.2 What is Container？</h3><p>Why is docker?-&gt; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.docker.com/resources/what-container">https://www.docker.com/resources/what-container</a></p>
<blockquote>
<p>A container is a standard unit of software that packages up code and all its dependencies so the application runs quickly and reliably from one computing environment to another.</p>
</blockquote>
<p>容器是打包代码及其所有依赖项的软件的标准单元，因此应用程序可以从一个计算环境快速可靠地运行到另一个计算环境。</p>
<p>1.2.3 Relation between image and container</p>
<blockquote>
<p>Container images become containers at runtime and in the case of Docker containers - images become containers when they run on Docker Engine.</p>
</blockquote>
<p>容器映像在运行时会成为容器，对于 Docker 容器而言-映像在 Docker Engine 上运行时会成为容器。</p>
<h3 id="1-2-4-View-from-Docs"><a href="#1-2-4-View-from-Docs" class="headerlink" title="1.2.4 View from Docs"></a>1.2.4 View from Docs</h3><blockquote>
<p>从帮助文档的角度看 docker 官网-&gt;Resources-&gt;Docs-&gt;Get started-&gt;Quickstart-&gt;Orientation and setup-&gt;Images and containers<br>Fundamentally, a container is nothing but a running process, with some added encapsulation features applied to it in order to keep it isolated from the host and from other containers. One of the most important aspects of container isolation is that each container interacts with its own, private filesystem; this filesystem is provided by a Docker image. An image includes everything needed to run an application – the code or binary, runtimes, dependencies, and any other filesystem objects required.</p>
</blockquote>
<p>从根本上说，一个容器不过是一个正在运行的进程，并对其应用了一些附加的封装功能，以使其与主机和其他容器隔离。 容器隔离的最重要方面之一是每个容器都与自己的私有文件系统进行交互。 该文件系统由 Docker 映像提供。 映像包括运行应用程序所需的所有内容-代码或二进制文件，运行时，依赖项以及所需的任何其他文件系统对象。</p>
<h2 id="1-3-Containers-and-virtual-machines"><a href="#1-3-Containers-and-virtual-machines" class="headerlink" title="1.3 Containers and virtual machines"></a>1.3 Containers and virtual machines</h2><blockquote>
<p>从帮助文档的角度看 docker 官网-&gt;Resources-&gt;Docs-&gt;Get started-&gt;Quickstart-&gt;Orientation and setup-&gt;Containers and virtual machines<br>A container runs natively on Linux and shares the kernel of the host machine with other containers. It runs a discrete process, taking no more memory than any other executable, making it lightweight.<br>By contrast, a virtual machine (VM) runs a full-blown “guest” operating system with virtual access to host resources through a hypervisor. In general, VMs incur a lot of overhead beyond what is being consumed by your application logic.</p>
</blockquote>
<p>容器在 Linux 上本地运行，并与其他容器共享主机的内核。 它运行一个离散进程，不占用任何其他可执行文件更多的内存，从而使其轻巧。</p>
<p>相比之下，虚拟机（VM）运行成熟的“来宾”操作系统，并通过虚拟机管理程序对主机资源进行虚拟访问。 通常，VM 会产生大量开销，超出了应用程序逻辑所消耗的开销。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/png/1082206/1584290839290-c72a16d5-fed8-4790-83d1-ead1c7e1128c.png#align=left&display=inline&height=570&margin=%5Bobject%20Object%5D&originHeight=570&originWidth=1241&size=0&status=done&style=none&width=1241"></p>
<h2 id="1-4-Docker-Engine-and-Architecture"><a href="#1-4-Docker-Engine-and-Architecture" class="headerlink" title="1.4 Docker Engine and Architecture"></a>1.4 Docker Engine and Architecture</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.docker.com/engine/docker-overview/">https://docs.docker.com/engine/docker-overview/</a></p>
<h3 id="1-4-1-Docker-Engine"><a href="#1-4-1-Docker-Engine" class="headerlink" title="1.4.1 Docker Engine"></a>1.4.1 Docker Engine</h3><blockquote>
<p>Docker Engine is a client-server application with these major components:</p>
<ul>
<li>A server which is a type of long-running program called a daemon process (the dockerd command).</li>
<li>A REST API which specifies interfaces that programs can use to talk to the daemon and instruct it what to do.</li>
<li>A command line interface (CLI) client (the docker command).</li>
</ul>
</blockquote>
<p>Docker Engine 是具有这些主要组件的客户端-服务器应用程序：</p>
<ul>
<li>一种长期运行的程序，称为守护程序进程（dockerd 命令）的服务。</li>
<li>REST API，它指定程序可以用来与守护程序进行通信并指示其操作的接口。</li>
<li>命令行界面（CLI）客户端（docker 命令）。</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2020/png/1082206/1584290841950-391fbc8e-45ef-453e-a9cc-630e1e6445ad.png#align=left&display=inline&height=385&margin=%5Bobject%20Object%5D&originHeight=385&originWidth=492&size=0&status=done&style=none&width=492"></p>
<h3 id="1-4-2-Docker-Architecture"><a href="#1-4-2-Docker-Architecture" class="headerlink" title="1.4.2 Docker Architecture"></a>1.4.2 Docker Architecture</h3><blockquote>
<p>Docker uses a client-server architecture. The Docker client talks to the Docker daemon, which does the heavy lifting of building, running, and distributing your Docker containers. The Docker client and daemon can run on the same system, or you can connect a Docker client to a remote Docker daemon. The Docker client and daemon communicate using a REST API, over UNIX sockets or a network interface.</p>
</blockquote>
<p>Docker 使用客户端-服务器架构。 Docker 客户端与 Docker 守护程序进行对话，该守护程序完成了构建，运行和分发 Docker 容器的繁重工作。 Docker 客户端和守护程序可以在同一系统上运行，也可以将 Docker 客户端连接到远程 Docker 守护程序。 Docker 客户端和守护程序在 UNIX 套接字或网络接口上使用 REST API 进行通信。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/svg/1082206/1584290842528-521f92e0-46f5-4965-9049-18fe40b60054.svg#align=left&display=inline&height=527&margin=%5Bobject%20Object%5D&originHeight=527&originWidth=1009&size=0&status=done&style=none&width=1009"></p>
<h2 id="1-5-Install"><a href="#1-5-Install" class="headerlink" title="1.5 Install"></a>1.5 Install</h2><p>见附件</p>
<h1 id="02-Image-and-Container"><a href="#02-Image-and-Container" class="headerlink" title="02 Image and Container"></a>02 Image and Container</h1><h2 id="2-1-Image"><a href="#2-1-Image" class="headerlink" title="2.1 Image"></a>2.1 Image</h2><h3 id="2-1-1-官方-image"><a href="#2-1-1-官方-image" class="headerlink" title="2.1.1 官方 image"></a>2.1.1 官方 image</h3><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/docker-library">https://github.com/docker-library</a></p>
<p>mysql</p>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/docker-library/mysql/blob/master/5.7/Dockerfile">https://github.com/docker-library/mysql/blob/master/5.7/Dockerfile</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">FROM debian:stretch-slim</span><br><span class="line"></span><br><span class="line"># add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added</span><br><span class="line">RUN groupadd -r mysql &amp;&amp; useradd -r -g mysql mysql</span><br><span class="line"></span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends gnupg dirmngr &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br><span class="line"></span><br><span class="line"># add gosu for easy step-down from root</span><br><span class="line">ENV GOSU_VERSION 1.7</span><br><span class="line">RUN set -x \</span><br><span class="line">	&amp;&amp; apt-get update &amp;&amp; apt-get install -y --no-install-recommends ca-certificates wget &amp;&amp; rm -rf /var/lib/apt/lists/* \</span><br><span class="line">	&amp;&amp; wget -O /usr/local/bin/gosu &quot;https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$(dpkg --print-architecture)&quot; \</span><br><span class="line">	&amp;&amp; wget -O /usr/local/bin/gosu.asc &quot;https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$(dpkg --print-architecture).asc&quot; \</span><br><span class="line">	&amp;&amp; export GNUPGHOME=&quot;$(mktemp -d)&quot; \</span><br><span class="line">	&amp;&amp; gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 \</span><br><span class="line">	&amp;&amp; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu \</span><br><span class="line">	&amp;&amp; gpgconf --kill all \</span><br><span class="line">	&amp;&amp; rm -rf &quot;$GNUPGHOME&quot; /usr/local/bin/gosu.asc \</span><br><span class="line">	&amp;&amp; chmod +x /usr/local/bin/gosu \</span><br><span class="line">	&amp;&amp; gosu nobody true \</span><br><span class="line">	&amp;&amp; apt-get purge -y --auto-remove ca-certificates wget</span><br><span class="line"></span><br><span class="line">RUN mkdir /docker-entrypoint-initdb.d</span><br><span class="line"></span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \</span><br><span class="line"># for MYSQL_RANDOM_ROOT_PASSWORD</span><br><span class="line">		pwgen \</span><br><span class="line"># for mysql_ssl_rsa_setup</span><br><span class="line">		openssl \</span><br><span class="line"># FATAL ERROR: please install the following Perl modules before executing /usr/local/mysql/scripts/mysql_install_db:</span><br><span class="line"># File::Basename</span><br><span class="line"># File::Copy</span><br><span class="line"># Sys::Hostname</span><br><span class="line"># Data::Dumper</span><br><span class="line">		perl \</span><br><span class="line">	&amp;&amp; rm -rf /var/lib/apt/lists/*</span><br><span class="line"></span><br><span class="line">RUN set -ex; \</span><br><span class="line"># gpg: key 5072E1F5: public key &quot;MySQL Release Engineering &lt;mysql-build@oss.oracle.com&gt;&quot; imported</span><br><span class="line">	key=&#x27;A4A9406876FCBD3C456770C88C718D3B5072E1F5&#x27;; \</span><br><span class="line">	export GNUPGHOME=&quot;$(mktemp -d)&quot;; \</span><br><span class="line">	gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys &quot;$key&quot;; \</span><br><span class="line">	gpg --batch --export &quot;$key&quot; &gt; /etc/apt/trusted.gpg.d/mysql.gpg; \</span><br><span class="line">	gpgconf --kill all; \</span><br><span class="line">	rm -rf &quot;$GNUPGHOME&quot;; \</span><br><span class="line">	apt-key list &gt; /dev/null</span><br><span class="line"></span><br><span class="line">ENV MYSQL_MAJOR 5.7</span><br><span class="line">ENV MYSQL_VERSION 5.7.28-1debian9</span><br><span class="line"></span><br><span class="line">RUN echo &quot;deb http://repo.mysql.com/apt/debian/ stretch mysql-$&#123;MYSQL_MAJOR&#125;&quot; &gt; /etc/apt/sources.list.d/mysql.list</span><br><span class="line"></span><br><span class="line"># the &quot;/var/lib/mysql&quot; stuff here is because the mysql-server postinst doesn&#x27;t have an explicit way to disable the mysql_install_db codepath besides having a database already &quot;configured&quot; (ie, stuff in /var/lib/mysql/mysql)</span><br><span class="line"># also, we set debconf keys to make APT a little quieter</span><br><span class="line">RUN &#123; \</span><br><span class="line">		echo mysql-community-server mysql-community-server/data-dir select &#x27;&#x27;; \</span><br><span class="line">		echo mysql-community-server mysql-community-server/root-pass password &#x27;&#x27;; \</span><br><span class="line">		echo mysql-community-server mysql-community-server/re-root-pass password &#x27;&#x27;; \</span><br><span class="line">		echo mysql-community-server mysql-community-server/remove-test-db select false; \</span><br><span class="line">	&#125; | debconf-set-selections \</span><br><span class="line">	&amp;&amp; apt-get update &amp;&amp; apt-get install -y mysql-server=&quot;$&#123;MYSQL_VERSION&#125;&quot; &amp;&amp; rm -rf /var/lib/apt/lists/* \</span><br><span class="line">	&amp;&amp; rm -rf /var/lib/mysql &amp;&amp; mkdir -p /var/lib/mysql /var/run/mysqld \</span><br><span class="line">	&amp;&amp; chown -R mysql:mysql /var/lib/mysql /var/run/mysqld \</span><br><span class="line"># ensure that /var/run/mysqld (used for socket and lock files) is writable regardless of the UID our mysqld instance ends up having at runtime</span><br><span class="line">	&amp;&amp; chmod 777 /var/run/mysqld \</span><br><span class="line"># comment out a few problematic configuration values</span><br><span class="line">	&amp;&amp; find /etc/mysql/ -name &#x27;*.cnf&#x27; -print0 \</span><br><span class="line">		| xargs -0 grep -lZE &#x27;^(bind-address|log)&#x27; \</span><br><span class="line">		| xargs -rt -0 sed -Ei &#x27;s/^(bind-address|log)/#&amp;/&#x27; \</span><br><span class="line"># don&#x27;t reverse lookup hostnames, they are usually another container</span><br><span class="line">	&amp;&amp; echo &#x27;[mysqld]\nskip-host-cache\nskip-name-resolve&#x27; &gt; /etc/mysql/conf.d/docker.cnf</span><br><span class="line"></span><br><span class="line">VOLUME /var/lib/mysql</span><br><span class="line"></span><br><span class="line">COPY docker-entrypoint.sh /usr/local/bin/</span><br><span class="line">RUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compat</span><br><span class="line">ENTRYPOINT [&quot;docker-entrypoint.sh&quot;]</span><br><span class="line"></span><br><span class="line">EXPOSE 3306 33060</span><br><span class="line">CMD [&quot;mysqld&quot;]</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-Dockerfile"><a href="#2-1-2-Dockerfile" class="headerlink" title="2.1.2 Dockerfile"></a>2.1.2 Dockerfile</h3><h4 id="2-1-2-1-FROM"><a href="#2-1-2-1-FROM" class="headerlink" title="2.1.2.1 FROM"></a>2.1.2.1 FROM</h4><p>指定基础镜像，比如 FROM ubuntu:14.04</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:14.04</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-2-RUN"><a href="#2-1-2-2-RUN" class="headerlink" title="2.1.2.2 RUN"></a>2.1.2.2 RUN</h4><p>在镜像内部执行一些命令，比如安装软件，配置环境等，换行可以使用””</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN groupadd -r mysql &amp;&amp; useradd -r -g mysql mysql</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-3-ENV"><a href="#2-1-2-3-ENV" class="headerlink" title="2.1.2.3 ENV"></a>2.1.2.3 ENV</h4><p>设置变量的值，ENV MYSQL_MAJOR 5.7，可以通过 docker run –e key=value 修改，后面可以直接使 用${MYSQL_MAJOR}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ENV MYSQL_MAJOR 5.7</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-4-LABEL"><a href="#2-1-2-4-LABEL" class="headerlink" title="2.1.2.4 LABEL"></a>2.1.2.4 LABEL</h4><p>设置镜像标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LABEL email=&quot;732060461@qq.com&quot;</span><br><span class="line">LABEL name=&quot;kieran&quot;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-5-VOLUME"><a href="#2-1-2-5-VOLUME" class="headerlink" title="2.1.2.5 VOLUME"></a>2.1.2.5 VOLUME</h4><p>指定数据的挂在目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VOLUME /var/lib/mysql</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-6-COPY"><a href="#2-1-2-6-COPY" class="headerlink" title="2.1.2.6 COPY"></a>2.1.2.6 COPY</h4><p>将主机的文件复制到镜像内，如果目录不存在，会自动创建所需要的目录，注意只是复制，不会提取和 解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COPY docker-entrypoint.sh /usr/local/bin/</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-7-ADD"><a href="#2-1-2-7-ADD" class="headerlink" title="2.1.2.7 ADD"></a>2.1.2.7 ADD</h4><p>将主机的文件复制到镜像内，和 COPY 类似，只是 ADD 会对压缩文件提取和解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADD application.yml /etc/kieran/</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-8-WORKDIR"><a href="#2-1-2-8-WORKDIR" class="headerlink" title="2.1.2.8 WORKDIR"></a>2.1.2.8 WORKDIR</h4><p>指定镜像的工作目录，之后的命令都是基于此目录工作，若不存在则创建</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WORKDIR /usr/local</span><br><span class="line">WORKDIR tomcat</span><br><span class="line">RUN touch test.txt</span><br></pre></td></tr></table></figure>

<p>会在/usr/local/tomcat 下创建 test.txt 文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WORKDIR /root</span><br><span class="line">ADD app.yml test/</span><br></pre></td></tr></table></figure>

<p>会在/root/test 下多出一个 app.yml 文件</p>
<h4 id="2-1-2-9-CMD"><a href="#2-1-2-9-CMD" class="headerlink" title="2.1.2.9 CMD"></a>2.1.2.9 CMD</h4><p>容器启动的时候默认会执行的命令，若有多个 CMD 命令，则最后一个生效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CMD [&quot;mysqld&quot;]</span><br><span class="line">或</span><br><span class="line">CMD mysqld</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-10-ENTRYPOINT"><a href="#2-1-2-10-ENTRYPOINT" class="headerlink" title="2.1.2.10 ENTRYPOINT"></a>2.1.2.10 ENTRYPOINT</h4><p>和 CMD 的使用类似</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ENTRYPOINT [&quot;docker-entrypoint.sh&quot;]</span><br></pre></td></tr></table></figure>

<p>和 CMD 的不同：<br>docker run 执行时，会覆盖 CMD 的命令，而 ENTRYPOINT 不会</p>
<h4 id="2-1-2-11-EXPOSE"><a href="#2-1-2-11-EXPOSE" class="headerlink" title="2.1.2.11 EXPOSE"></a>2.1.2.11 EXPOSE</h4><p>指定镜像要暴露的端口，启动镜像时，可以使用-p 将该端口映射给宿主机</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPOSE 3306</span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-Dockerfile-实战-Spring-Boot-项目"><a href="#2-1-3-Dockerfile-实战-Spring-Boot-项目" class="headerlink" title="2.1.3 Dockerfile 实战 Spring Boot 项目"></a>2.1.3 Dockerfile 实战 Spring Boot 项目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">(1)创建一个Spring Boot项目</span><br><span class="line"></span><br><span class="line">(2)写一个controller</span><br><span class="line">@RestController</span><br><span class="line">public class DockerController &#123;</span><br><span class="line">    @GetMapping(&quot;/dockerfile&quot;)</span><br><span class="line">    @ResponseBody String dockerfile() &#123;</span><br><span class="line">        return &quot;hello docker&quot; ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">(3)mvn clean package打成一个jar包</span><br><span class="line">    在target下找到&quot;dockerfile-demo-0.0.1-SNAPSHOT.jar&quot;</span><br><span class="line"></span><br><span class="line">(4)在docker环境中新建一个目录&quot;first-dockerfile&quot;</span><br><span class="line"></span><br><span class="line">(5)上传&quot;dockerfile-demo-0.0.1-SNAPSHOT.jar&quot;到该目录下，并且在此目录创建Dockerfile</span><br><span class="line"></span><br><span class="line">(6)创建Dockerfile文件，编写内容</span><br><span class="line">FROM openjdk:8</span><br><span class="line">MAINTAINER kieran</span><br><span class="line">LABEL name=&quot;dockerfile-demo&quot; version=&quot;1.0&quot; author=&quot;kieran&quot;</span><br><span class="line">COPY dockerfile-demo-0.0.1-SNAPSHOT.jar dockerfile-image.jar</span><br><span class="line">CMD [&quot;java&quot;,&quot;-jar&quot;,&quot;dockerfile-image.jar&quot;]</span><br><span class="line"></span><br><span class="line">(7)基于Dockerfile构建镜像</span><br><span class="line">    docker build -t test-docker-image .</span><br><span class="line"></span><br><span class="line">(8)基于image创建container</span><br><span class="line">    docker run -d --name user01 -p 6666:8080 test-docker-image</span><br><span class="line"></span><br><span class="line">(9)查看启动日志docker logs user01</span><br><span class="line"></span><br><span class="line">(10)宿主机上访问</span><br><span class="line">    curl localhost:6666/dockerfile hello docker</span><br><span class="line"></span><br><span class="line">(11)还可以再次启动一个</span><br><span class="line">    docker run -d --name user02 -p 8081:8080 test-docker-image</span><br></pre></td></tr></table></figure>

<h3 id="2-1-4-镜像仓库"><a href="#2-1-4-镜像仓库" class="headerlink" title="2.1.4 镜像仓库"></a>2.1.4 镜像仓库</h3><h4 id="2-1-4-1-docker-hub"><a href="#2-1-4-1-docker-hub" class="headerlink" title="2.1.4.1 docker hub"></a>2.1.4.1 docker hub</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(1)在docker机器上登录</span><br><span class="line">    docker login</span><br><span class="line"></span><br><span class="line">(2)输入用户名和密码</span><br><span class="line"></span><br><span class="line">(3) 推送，[注意镜像名称要和docker id一致，不然push不成功]</span><br><span class="line">    docker push xxx/test-docker-image</span><br><span class="line"></span><br><span class="line">(4)给image重命名，并删除掉原来的</span><br><span class="line">    docker tag test-docker-image xxx/test-docker-image</span><br><span class="line">    docker rmi -f test-docker-image</span><br><span class="line"></span><br><span class="line">(5)再次推送，刷新hub.docker.com后台，发现成功</span><br><span class="line"></span><br><span class="line">(6)别人下载，并且运行</span><br><span class="line">    docker pull xxx/test-docker-image</span><br><span class="line">    docker run -d --name user01 -p 6661:8080 xxx/test-docker-image</span><br></pre></td></tr></table></figure>

<h4 id="2-1-4-2-阿里云-docker-hub"><a href="#2-1-4-2-阿里云-docker-hub" class="headerlink" title="2.1.4.2 阿里云 docker hub"></a>2.1.4.2 阿里云 docker hub</h4><blockquote>
<p>阿里云 docker 仓库<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://cr.console.aliyun.com/cn-hangzhou/instances/repositories">https://cr.console.aliyun.com/cn-hangzhou/instances/repositories</a><br>参考手册<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://cr.console.aliyun.com/repository/cn-hangzhou/kieran2019/test/details">https://cr.console.aliyun.com/repository/cn-hangzhou/kieran2019/test/details</a></p>
</blockquote>
<h4 id="2-1-4-3-搭建自己的-Docker-Harbor"><a href="#2-1-4-3-搭建自己的-Docker-Harbor" class="headerlink" title="2.1.4.3 搭建自己的 Docker Harbor"></a>2.1.4.3 搭建自己的 Docker Harbor</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(1)访问github上的harbor项目</span><br><span class="line">    https://github.com/goharbor/harbor</span><br><span class="line"></span><br><span class="line">(2)下载版本，比如1.7.1 https://github.com/goharbor/harbor/releases</span><br><span class="line"></span><br><span class="line">(3)找一台安装了docker-compose[见附件]，上传并解压</span><br><span class="line">    tar -zxvf xxx.tar.gz</span><br><span class="line"></span><br><span class="line">(4)进入到harbor目录 修改harbor.cfg文件，主要是ip地址的修改成当前机器的ip地址 同时也可以看到Harbor的密码，默认是Harbor12345</span><br><span class="line"></span><br><span class="line">(5)安装harbor，需要一些时间</span><br><span class="line">    sh install.sh</span><br><span class="line"></span><br><span class="line">(6)浏览器访问，比如39.108.121.24，输入用户名和密码即可</span><br></pre></td></tr></table></figure>

<h3 id="2-1-5-Image-常见操作"><a href="#2-1-5-Image-常见操作" class="headerlink" title="2.1.5 Image 常见操作"></a>2.1.5 Image 常见操作</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(1)查看本地image列表</span><br><span class="line">    docker images</span><br><span class="line">    docker image ls</span><br><span class="line"></span><br><span class="line">(2)获取远端镜像</span><br><span class="line">    docker pull</span><br><span class="line"></span><br><span class="line">(3)删除镜像[注意此镜像如果正在使用，或者有关联的镜像，则需要先处理完]</span><br><span class="line">    docker image rm imageid</span><br><span class="line">    docker rmi -f imageid</span><br><span class="line">    docker rmi -f $(docker image ls) 删除所有镜像</span><br><span class="line"></span><br><span class="line">(4)运行镜像</span><br><span class="line">    docker run image</span><br><span class="line"></span><br><span class="line">(5)发布镜像</span><br><span class="line">    docker push</span><br></pre></td></tr></table></figure>

<h2 id="2-2-Container"><a href="#2-2-Container" class="headerlink" title="2.2 Container"></a>2.2 Container</h2><p>既然 container 是由 image 运行起来的，那么是否可以理解为 container 和 image 有某种关系？<br>其实可以理解为 container 只是基于 image 之后的 layer 而已，也就是可以通过 docker run image 创建出一个 container 出来。</p>
<h3 id="2-2-1-container-到-image"><a href="#2-2-1-container-到-image" class="headerlink" title="2.2.1 container 到 image"></a>2.2.1 container 到 image</h3><p>既然 container 是基于 image 之上的，想想是否能够由一个 container 反推出 image 呢？ 肯定是可以的，比如通过 docker run 运行起一个 container 出来，这时候对 container 对一些修 改，然后再生成一个新的 image，这时候 image 的由来就不仅仅只能通过 Dockerfile 咯。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(1)拉取一个centos image</span><br><span class="line">    docker pull centos</span><br><span class="line"></span><br><span class="line">(2)根据centos镜像创建出一个container</span><br><span class="line">    docker run -d -it --name my-centos centos</span><br><span class="line"></span><br><span class="line">(3)进入my-centos容器中</span><br><span class="line">    docker exec -it my-centos bash</span><br><span class="line"></span><br><span class="line">(4)输入vim命令</span><br><span class="line">    bash: vim: command not found</span><br><span class="line"></span><br><span class="line">(5)我们要做的是 对该container进行修改，也就是安装一下vim命令，然后将其生成一个新的centos</span><br><span class="line"></span><br><span class="line">(6)在centos的container中安装vim</span><br><span class="line">    yum install -y vim</span><br><span class="line"></span><br><span class="line">(7)退出容器，将其生成一个新的centos，名称为&quot;vim-centos-image&quot;</span><br><span class="line">    docker commit my-centos vim-centos-image</span><br><span class="line"></span><br><span class="line">(8)查看镜像列表，并且基于&quot;vim-centos-image&quot;创建新的容器</span><br><span class="line">    docker run -d -it --name my-vim-centos vim-centos-image</span><br><span class="line"></span><br><span class="line">(9)进入到my-vim-centos容器中，检查vim命令是否存在</span><br><span class="line">    docker exec -it my-vim-centos bash</span><br><span class="line">    vim</span><br></pre></td></tr></table></figure>

<p>可以通过 docker commit 命令基于一个 container 重新生成一个 image，但是一般得到 image 的 方式不建议这么做，不然 image 怎么来的就全然不知道了。</p>
<h3 id="2-2-2-container-资源限制"><a href="#2-2-2-container-资源限制" class="headerlink" title="2.2.2 container 资源限制"></a>2.2.2 container 资源限制</h3><p>如果不对 container 的资源做限制，它就会无限制地使用物理机的资源，这样显然是不合适的。<br>查看资源情况 ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stats</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-1-内存限制"><a href="#2-2-2-1-内存限制" class="headerlink" title="2.2.2.1 内存限制"></a>2.2.2.1 内存限制</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--memory Memory limit</span><br><span class="line">如果不设置 --memory-swap，其大小和memory一样</span><br><span class="line">docker run -d --memory 100M --name tomcat1 tomcat</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-2-CPU-限制"><a href="#2-2-2-2-CPU-限制" class="headerlink" title="2.2.2.2 CPU 限制"></a>2.2.2.2 CPU 限制</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--cpu-shares 权重</span><br><span class="line">docker run -d --cpu-shares 10 --name tomcat2 tomcat</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-3-图形化资源监控"><a href="#2-2-2-3-图形化资源监控" class="headerlink" title="2.2.2.3 图形化资源监控"></a>2.2.2.3 图形化资源监控</h4><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/weaveworks/scope">https://github.com/weaveworks/scope</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L git.io/scope -o /usr/local/bin/scope</span><br><span class="line">sudo chmod a+x /usr/local/bin/scope</span><br><span class="line">scope launch 39.108.121.24</span><br><span class="line"></span><br><span class="line"># 停止scope scope stop</span><br><span class="line"># 同时监控两台机器，在两台机器中分别执行如下命令</span><br><span class="line">scope launch ip1 ip2</span><br></pre></td></tr></table></figure>

<p>2.2.3 container 常见操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">(1)根据镜像创建容器</span><br><span class="line">    docker run -d --name -p 9090:8080 my-tomcat tomcat</span><br><span class="line"></span><br><span class="line">(2)查看运行中的container</span><br><span class="line">    docker ps</span><br><span class="line"></span><br><span class="line">(3)查看所有的container[包含退出的]</span><br><span class="line">    docker ps -a</span><br><span class="line"></span><br><span class="line">(4)删除container</span><br><span class="line">    docker rm containerid</span><br><span class="line">    docker rm -f $(docker ps -a) 删除所有container</span><br><span class="line"></span><br><span class="line">(5)进入到一个container中</span><br><span class="line">    docker exec -it container bash</span><br><span class="line"></span><br><span class="line">(6)根据container生成image</span><br><span class="line">    docker commit my-centos vim-centos-image</span><br><span class="line"></span><br><span class="line">(7)查看某个container的日志</span><br><span class="line">    docker logs container</span><br><span class="line"></span><br><span class="line">(8)查看容器资源使用情况</span><br><span class="line">    docker stats</span><br><span class="line"></span><br><span class="line">(9)查看容器详情信息</span><br><span class="line">    docker inspect container</span><br><span class="line"></span><br><span class="line">(10)停止/启动容器</span><br><span class="line">    docker stop/start container</span><br></pre></td></tr></table></figure>

<h2 id="2-3-底层技术支持"><a href="#2-3-底层技术支持" class="headerlink" title="2.3 底层技术支持"></a>2.3 底层技术支持</h2><p>Container 是一种轻量级的虚拟化技术，不用模拟硬件创建虚拟机。 Docker 是基于 Linux Kernel 的 Namespace、CGroups、UnionFileSystem 等技术封装成的一种自 定义容器格式，从而提供一套虚拟运行环境。</p>
<blockquote>
<p>Namespace：用来做隔离的，比如 pid[进程]、net[网络]、mnt[挂载点]等<br>CGroups: Controller Groups 用来做资源限制，比如内存和 CPU 等<br>Union file systems：用来做 image 和 container</p>
</blockquote>
<h1 id="03-附件"><a href="#03-附件" class="headerlink" title="03 附件"></a>03 附件</h1><h2 id="3-1-mac-搭建-docker、docker-compose-环境"><a href="#3-1-mac-搭建-docker、docker-compose-环境" class="headerlink" title="3.1 mac 搭建 docker、docker-compose 环境"></a>3.1 mac 搭建 docker、docker-compose 环境</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5affada36fb9a07abf72c6e5">https://juejin.im/post/5affada36fb9a07abf72c6e5</a></p>
<h2 id="3-2-docker-compose-yml-配置详解"><a href="#3-2-docker-compose-yml-配置详解" class="headerlink" title="3.2 docker-compose.yml 配置详解"></a>3.2 docker-compose.yml 配置详解</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5aed4a776fb9a07a9918bb42">https://juejin.im/post/5aed4a776fb9a07a9918bb42</a></p>
<h1 id="待续…"><a href="#待续…" class="headerlink" title="待续…"></a>待续…</h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://www.khalidlife.com">Khalid</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.khalidlife.com/posts/yulz9f.html">https://www.khalidlife.com/posts/yulz9f.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="external nofollow noopener noreferrer">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.khalidlife.com" target="_blank">Khalid博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/docker/">docker</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/9ce2be41db3743b4b59d1da0bf3616ad.jpg" target="_blank" rel="external nofollow noopener noreferrer"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/9ce2be41db3743b4b59d1da0bf3616ad.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/9ce2be41db3743b4b59d1da0bf3616ad.jpg" target="_blank" rel="external nofollow noopener noreferrer"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/9ce2be41db3743b4b59d1da0bf3616ad.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/mndre9.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">linux下安装docker与docker-compose</div></div></a></div><div class="next-post pull-right"><a href="/posts/hh7l8d.html"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JVM介绍</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/mndre9.html" title="linux下安装docker与docker-compose"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-10</div><div class="title">linux下安装docker与docker-compose</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/avatar_betacat_07.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">Khalid</div><div class="author-info__description">Whatever you go, go with all your heart</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/khalidzk"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/khalidzk" target="_blank" title rel="external nofollow noopener noreferrer"><i class="fa fa-github"></i></a><a class="social-icon" href="mailto:khalidlife@163.com" target="_blank" title rel="external nofollow noopener noreferrer"><i class="fa fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#01-%E5%88%9D%E8%AF%86-Docker"><span class="toc-number">1.</span> <span class="toc-text">01 初识 Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-What-is-Docker"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 What is Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-%E5%AE%98%E7%BD%91%E9%A6%96%E9%A1%B5"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 官网首页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-Docs"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 Docs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-%E4%B8%8D%E7%90%86%E8%A7%A3%EF%BC%8C%E6%88%91%E5%A4%AA%E9%9A%BE%E4%BA%86"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 不理解，我太难了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-4-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3-Docker"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.1.4 再次理解 Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-5-Docker-%E7%9A%84%E4%BC%98%E5%8A%BF%E5%92%8C%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.1.5 Docker 的优势和应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-What-is-Image-and-Container"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 What is Image and Container?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-What-is-Image"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 What is Image?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-What-is-Container%EF%BC%9F"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 What is Container？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-4-View-from-Docs"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.2.4 View from Docs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-Containers-and-virtual-machines"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 Containers and virtual machines</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-Docker-Engine-and-Architecture"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 Docker Engine and Architecture</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-1-Docker-Engine"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.4.1 Docker Engine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-2-Docker-Architecture"><span class="toc-number">1.4.2.</span> <span class="toc-text">1.4.2 Docker Architecture</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-Install"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 Install</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#02-Image-and-Container"><span class="toc-number">2.</span> <span class="toc-text">02 Image and Container</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Image"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 Image</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E5%AE%98%E6%96%B9-image"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 官方 image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-Dockerfile"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 Dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-1-FROM"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">2.1.2.1 FROM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-2-RUN"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">2.1.2.2 RUN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-3-ENV"><span class="toc-number">2.1.2.3.</span> <span class="toc-text">2.1.2.3 ENV</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-4-LABEL"><span class="toc-number">2.1.2.4.</span> <span class="toc-text">2.1.2.4 LABEL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-5-VOLUME"><span class="toc-number">2.1.2.5.</span> <span class="toc-text">2.1.2.5 VOLUME</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-6-COPY"><span class="toc-number">2.1.2.6.</span> <span class="toc-text">2.1.2.6 COPY</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-7-ADD"><span class="toc-number">2.1.2.7.</span> <span class="toc-text">2.1.2.7 ADD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-8-WORKDIR"><span class="toc-number">2.1.2.8.</span> <span class="toc-text">2.1.2.8 WORKDIR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-9-CMD"><span class="toc-number">2.1.2.9.</span> <span class="toc-text">2.1.2.9 CMD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-10-ENTRYPOINT"><span class="toc-number">2.1.2.10.</span> <span class="toc-text">2.1.2.10 ENTRYPOINT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-11-EXPOSE"><span class="toc-number">2.1.2.11.</span> <span class="toc-text">2.1.2.11 EXPOSE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-3-Dockerfile-%E5%AE%9E%E6%88%98-Spring-Boot-%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 Dockerfile 实战 Spring Boot 项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-4-%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4 镜像仓库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-1-docker-hub"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">2.1.4.1 docker hub</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-2-%E9%98%BF%E9%87%8C%E4%BA%91-docker-hub"><span class="toc-number">2.1.4.2.</span> <span class="toc-text">2.1.4.2 阿里云 docker hub</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-3-%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84-Docker-Harbor"><span class="toc-number">2.1.4.3.</span> <span class="toc-text">2.1.4.3 搭建自己的 Docker Harbor</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-5-Image-%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C"><span class="toc-number">2.1.5.</span> <span class="toc-text">2.1.5 Image 常见操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Container"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 Container</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-container-%E5%88%B0-image"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 container 到 image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-container-%E8%B5%84%E6%BA%90%E9%99%90%E5%88%B6"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 container 资源限制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-1-%E5%86%85%E5%AD%98%E9%99%90%E5%88%B6"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">2.2.2.1 内存限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-2-CPU-%E9%99%90%E5%88%B6"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">2.2.2.2 CPU 限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-3-%E5%9B%BE%E5%BD%A2%E5%8C%96%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7"><span class="toc-number">2.2.2.3.</span> <span class="toc-text">2.2.2.3 图形化资源监控</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E5%BA%95%E5%B1%82%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 底层技术支持</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#03-%E9%99%84%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">03 附件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-mac-%E6%90%AD%E5%BB%BA-docker%E3%80%81docker-compose-%E7%8E%AF%E5%A2%83"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 mac 搭建 docker、docker-compose 环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-docker-compose-yml-%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 docker-compose.yml 配置详解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BE%85%E7%BB%AD%E2%80%A6"><span class="toc-number">4.</span> <span class="toc-text">待续…</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/zfidhe.html" title="NVM与Node环境安装"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NVM与Node环境安装"></a><div class="content"><a class="title" href="/posts/zfidhe.html" title="NVM与Node环境安装">NVM与Node环境安装</a><time datetime="2022-05-15T07:33:00.000Z" title="发表于 2022-05-15 15:33:00">2022-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/krc62u.html" title="Java并发编程"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java并发编程"></a><div class="content"><a class="title" href="/posts/krc62u.html" title="Java并发编程">Java并发编程</a><time datetime="2022-02-24T00:30:50.000Z" title="发表于 2022-02-24 08:30:50">2022-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/umrbri.html" title="Centos免密登录"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Centos免密登录"></a><div class="content"><a class="title" href="/posts/umrbri.html" title="Centos免密登录">Centos免密登录</a><time datetime="2021-07-22T05:08:00.000Z" title="发表于 2021-07-22 13:08:00">2021-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/pgw7at.html" title="OpenVPN安装与配置"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenVPN安装与配置"></a><div class="content"><a class="title" href="/posts/pgw7at.html" title="OpenVPN安装与配置">OpenVPN安装与配置</a><time datetime="2021-07-11T07:44:01.000Z" title="发表于 2021-07-11 15:44:01">2021-07-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/lxe2lp.html" title="IDEA插件系列-EasyYapi"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="IDEA插件系列-EasyYapi"></a><div class="content"><a class="title" href="/posts/lxe2lp.html" title="IDEA插件系列-EasyYapi">IDEA插件系列-EasyYapi</a><time datetime="2021-02-26T04:49:00.000Z" title="发表于 2021-02-26 12:49:00">2021-02-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Khalid</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.beian.miit.gov.cn/"><img class="icp-icon" src="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/img/icp.png"><span>浙ICP备17028699号-3</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="7468913728" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script src="https://cdn.jsdelivr.net/gh/khalidzk/kieran-source@master/js/butterfly.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>